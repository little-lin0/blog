<!DOCTYPE html>
<html lang="zxx">

<head>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>Cateogry</title>
    <link rel="stylesheet" href="lib/layui-v2.6.3/css/layui.css">

    <!-- css include -->
    <link rel="stylesheet" type="text/css" href="css/materialize.css">
    <link rel="stylesheet" type="text/css" href="css/icofont.css">
    <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css">
    <link rel="stylesheet" type="text/css" href="css/owl.theme.default.min.css">

    <!-- my css include -->
    <link rel="stylesheet" type="text/css" href="css/custom-menu.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/responsive.css">
    <link rel="stylesheet" href="css/extra.css">

</head>


<body>


<div class="thetop"></div>
<!-- for back to top -->

<div class='backToTop'>
    <a href="#" class='scroll'>
        <span>T</span>
        <span>O</span>
        <span>P</span>
        <span class="go-up">
					<i class="icofont icofont-long-arrow-up"></i>
				</span>
    </a>
</div>
<!-- backToTop -->

<!-- ==================== header-section Start ==================== -->
<header id="header-section" class="header-section w100dt navbar-fixed">

    <nav class="nav-extended main-nav">
        <div class="container">
            <div class="row">
                <div class="nav-wrapper w100dt">

                    <div class="logo left">
                        <a href="index.html" class="brand-logo">
                            <img src="img/kir.png"  alt="brand-logo">
                        </a>
                    </div>
                    <!-- logo -->

                    <div>
                        <a href="#" data-activates="mobile-demo" class="button-collapse">
                            <i class="icofont icofont-navigation-menu"></i>
                        </a>
                        <ul id="nav-mobile" class="main-menu center-align hide-on-med-and-down">
                            <li class="active"><a href="index.html">HOME</a></li>
                            <li><a href="cateogry.html">CATEGORIES</a></li>
                            <li><a href="about.html">ABOUT</a></li>
                            <li><a href="contact.html">CONTACT</a></li>
                            <li class="dropdown userSwitch">
                                <a href="login.html" id="user">~请登录~</a>
                                <ul class="dropdown-container">
                                    <li><a href="swithUser">切换用户</a></li>
                                    <li><a href="/logout">退出</a></li>
                                </ul>
                            </li>
                        </ul>
                        <!-- /.main-menu -->

                        <!-- ******************** sidebar-menu ******************** -->
                        <ul class="side-nav" id="mobile-demo">
                            <li class="snavlogo center-align"><img src="img/kir.png" alt="logo"></li>
                            <li class="active"><a href="index.html">HOME</a></li>
                            <li><a href="cateogry.html">CATEGORIES</a></li>
                            <li><a href="about.html">ABOUT</a></li>
                            <li><a href="contact.html">CONTACT</a></li>
                            <li><a href="single-blog.html.html" style="display: none" id="person">我的主页</a></li>

                        </ul>
                    </div>
                    <!-- main-menu -->

                    <a href="#" class="search-trigger right">
                        <i class="icofont icofont-search" style="font-size: 18px;"></i>
                    </a>
                    <a href="writeblog.html" class="writeBlog right" title="写博客">
                        <i class="layui-icon layui-icon-add-circle" style="font-size: 30px; color: #000000;"></i>
                    </a>
                    <!-- search -->
                    <div id="myNav" class="overlay">
                        <a href="javascript:void(0)" class="closebtn">&times;</a>
                        <div class="overlay-content">
                            <form action="search.html" method="get">
                                <input type="text" name="key" placeholder="Search...">
                                <br>
                                <button class="waves-effect waves-light" type="submit" >Search</button>
                            </form>
                        </div>
                    </div>

                </div>
                <!-- /.nav-wrapper -->
            </div>
            <!-- row -->
        </div>
        <!-- container -->
    </nav>

</header>
<!-- /#header-section -->
<!-- ==================== header-section End ==================== -->


<!-- ==================== header-section Start ==================== -->
<section id="breadcrumb-section" class="breadcrumb-section w100dt mb-30">
    <div class="container">

        <nav class="breadcrumb-nav w100dt">
            <div class="page-name hide-on-small-only left" style="width: 50%;color: black">
                						<h4>Search</h4>



                <!--						<div class="layui-form">-->
                <!--							<div class="layui-form-item">-->
                <!--								<input class=" layui-border-blue" type="text" name="key" id="" >-->
                <!--							</div>-->
                <!--						</div>-->
            </div>
            <div class="nav-wrapper right">
                <a href="#!" class="breadcrumb">Home</a>
                <a href="#!" class="breadcrumb active">Search</a>
            </div>
            <!-- /.nav-wrapper -->
        </nav>
        <!-- /.breadcrumb-nav -->

    </div>
    <!-- container -->
</section>
<!-- /.breadcrumb-section -->
<!-- ==================== header-section End ==================== -->


<!-- ==================== cateogry-section start ==================== -->
<section id="cateogry-section" class="cateogry-section w100dt mb-50">
    <div class="container">
        <div class="row">

            <div class="col s12 m8 l8">
<!--                搜索栏-->
                <div class="row" style="background-color: white;margin-left: auto;margin-right: auto;margin-bottom:20px;padding: 20px">

                    <div class="col s12 m12 l8">
                        <input class="col s10 m10 " type="text" name="key" placeholder="search" id="search-box" >
                        <button id="search" class="layui-btn layui-btn-normal layui-btn-sm col s2 m2"
                                style="height: 45px; position: relative;bottom: 1px;right: 42px" >
                            <i class="m6 layui-icon layui-icon-search" style="color: white;font-size: 27px"></i>
                        </button>
                    </div>

<!--                <div class="layui-row">-->
                    <div class="search-info  col s12 m12 ">
                        <h4 class="count"></h4>
                    </div>
                    <div class="search-class  col s12 m12  ">
                        <ul class="col s12 m12 " >
                            <li class=" col s2 m1 Class" style="margin-right: 10px" id="blog">分类:</li>
                            <li class="article  col s2 m1 " style="margin-right: 10px">博文</li>
                            <li class="user col s2 m1 " style="margin-right: 10px">用户</li>
                        </ul>
                    </div>
                    <div class="search-order  col s12 m12 ">
                        <ul>
                            <li class=" col s2 m1 " style="margin-right: 10px">排序:</li>
                            <li class="a-order col s3 m2" id="date" style="margin-right: 10px">最新发表</li>
                            <li class="a-order col s3 m2" id="view" style="margin-right: 10px">最多观看</li>
                            <li class="a-order col s3 m2" id="good" >最多点赞</li>
                            <li style="display: none" class="u-order col s5 m2" id="follow" style="margin-right: 10px">粉丝最多</li>
                            <li style="display: none" class="u-order col s5 m2" id="article" style="margin-right: 10px">博文最多</li>
                        </ul>
                    </div>
<!--                </div>-->

                </div>

                <div class="row" id="list">



                    <!-- colm6 -->
                </div>
                <!-- row -->
                <!--						分页-->
                <div id="pagination"></div>

            </div>
            <!-- colm8 -->


            <!--侧边栏-->
            <div class="col s12 m4 l4">

                <div style="display: none" class="sidebar-testimonial mb-30">
                    <div class="sidebar-title center-align">
                        <h2>Hi Its Me!</h2>
                    </div>
                    <!-- /.sidebar-title -->

                    <div class="carousel carousel-slider center" data-indicators="true">
                        <div class="carousel-item">
                            <div class="item-img">
                                <span>R</span>
                            </div>
                            <h2>Rakibul Hassan</h2>
                            <small>Web Design & Development</small>
                            <p>
                                Sedut perspiciatis unde omnis iste natus errorsit voluptatem accusantium doloremque.
                            </p>
                        </div>
                        <div class="carousel-item">
                            <div class="item-img">
                                <span>O</span>
                            </div>
                            <h2>Rakibul Hassan</h2>
                            <small>Web Design & Development</small>
                            <p>
                                Sedut perspiciatis unde omnis iste natus errorsit voluptatem accusantium doloremque.
                            </p>
                        </div>
                        <div class="carousel-item">
                            <div class="item-img">
                                <span>K</span>
                            </div>
                            <h2>Rakibul Hassan</h2>
                            <small>Web Design & Development</small>
                            <p>
                                Sedut perspiciatis unde omnis iste natus errorsit voluptatem accusantium doloremque.
                            </p>
                        </div>
                        <div class="carousel-item">
                            <div class="item-img">
                                <span>I</span>
                            </div>
                            <h2>Rakibul Hassan</h2>
                            <small>Web Design & Development</small>
                            <p>
                                Sedut perspiciatis unde omnis iste natus errorsit voluptatem accusantium doloremque.
                            </p>
                        </div>
                        <div class="carousel-item">
                            <div class="item-img">
                                <span>B</span>
                            </div>
                            <h2>Rakibul Hassan</h2>
                            <small>Web Design & Development</small>
                            <p>
                                Sedut perspiciatis unde omnis iste natus errorsit voluptatem accusantium doloremque.
                            </p>
                        </div>
                    </div>
                </div>
                <!-- /.sidebar-testimonial -->

                <div style="display: block" class="sidebar-box bg-box sidebar-tags">
                    <h6 class="sidebar-title">热门搜索</h6>
                    <ul class="clearfix" id="keyword">

                    </ul>
                </div>



                <div class="featured-posts w100dt mb-30">
                    <div class="sidebar-title center-align">
                        <h2>Featured Posts</h2>
                    </div>
                    <!-- /.sidebar-title -->

                    <div class="sidebar-posts" id="feature">

                    </div>
                    <!-- /.sidebar-posts -->

                </div>
                <!-- /.featured-posts -->


                <div class="top-post w100dt mb-30">
                    <div class="sidebar-title center-align">
                        <h2>Top Posts</h2>
                    </div>
                    <!-- /.sidebar-title -->

                    <ul id="tabs-swipe-demo" class="top-post-tab tabs tabs-fixed-width">
                        <li class="tab"><a href="#test-swipe-1" class="active">Most Views</a></li>
                        <li class="tab"><a href="#test-swipe-2">Recent</a></li>
                        <li class="tab"><a href="#test-swipe-3">Comments</a></li>
                    </ul>

                    <div id="test-swipe-1" class="tab-contant most-view">



                    </div>
                    <!-- /.most-view -->


                    <div id="test-swipe-2" class="tab-contant recent-post">



                    </div>
                    <!-- /.recent-post -->


                    <div id="test-swipe-3" class="tab-contant Comments-post">

                        <div class="card-panel grey lighten-5 z-depth-1">
                            <div class="row valign-wrapper">
                                <div class="col s3">
                                    <img src="img/img1.png" alt="Image" class="circle responsive-img">
                                    <!-- notice the "circle" class -->
                                </div>
                                <div class="col s9">
											<span class="black-text">
												Lorem ipsum dolor sit amet, consectetur adipisicing elit.
											</span>
                                </div>
                            </div>
                        </div>
                        <!-- card-panel -->



                    </div>
                    <!-- /.tab-contant -->
                </div>
                <!-- /.top-post -->


            </div>
            <!-- colm4 -->

        </div>
        <!-- row -->
    </div>
    <!-- container -->
</section>
<!-- /#cateogry-section -->
<!-- ==================== cateogry-section end ==================== -->



<!-- ==================== footer-section Start ==================== -->
<footer id="footer-section" class="footer-section w100dt">
    <div class="container">

        <div class="footer-logo w100dt center-align mb-30">
            <a href="#" class="brand-logo">
                <img src="img/kir.png" alt="brand-logo">
            </a>
        </div>
        <!-- /.footer-logo -->

        <ul class="footer-social-links w100dt center-align mb-30">
            <li><a href="#" class="facebook">微信</a></li>
            <li><a href="#" class="twitter">QQ</a></li>
            <li><a href="#" class="google-plus">微博</a></li>
        </ul>

        <p class="center-align">
            <i class="icofont icofont-heart-alt l-blue"></i>
            Copyright &copy; 2021 <a target="_blank" href="/"> KIT SECRET</a>
            &nbsp | &nbsp <img src="img/icp.png" style="width: 18px"> <a href="https://beian.miit.gov.cn/#/Integrated/index">粤ICP备2021073345号</a>
        </p>

    </div>
    <!-- container -->
</footer>
<!-- /#footer-section -->
<!-- ==================== footer-section End ==================== -->


<!-- my custom js -->
<script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="js/materialize.js"></script>
<script type="text/javascript" src="js/owl.carousel.min.js"></script>
<script type="text/javascript" src="lib/layui-v2.6.3/layui.js"></script>
<script src="js/jquery.cookie.js"></script>
<!-- my custom js -->
<script type="text/javascript" src="js/custom.js"></script>
<!--		数据模板-->
<script id="side_feature" type="text/html">
    {{# for (var i = 0; i < d.length; i++){ }}
    <div class="card">
        <div class="card-image mb-10">
            <a href="single-blog.html?id={{d[i].id}}"> <img src="{{d[i].cover}}" alt="Image"></a>
            <span class="effect"></span>
        </div>
        <!-- /.card-image -->
        <div class="card-content w100dt">
            <p>
                <a  class="tag left w100dt l-blue mb-10">{{d[i].label}}</a>
            </p>
            <a href="single-blog.html?id={{d[i].id}}" class="card-title">
                {{d[i].title}}
            </a>
            <ul class="post-mate-time left">
                <li>
                    <p class="hero left">
                        By - <a href="personal.html?id={{d[i].authorId}}" class="l-blue">{{d[i].author_name}}</a>
                    </p>
                </li>
            </ul>

            <ul class="post-mate right">
                <li class="like">

                    <i class="icofont icofont-heart-alt"></i> {{d[i].good}}

                </li>
                <li class="comment">

                    <i class="icofont icofont-comment"></i> {{d[i].view}}

                </li>
            </ul>
        </div>
        <!-- /.card-content -->
    </div>
    {{# } }}
</script>
<script id="side_order_view" type="text/html">
    <div class="sidebar-posts">
        <div class="card">
            <div class="card-image mb-10">
                <a href="single-blog.html?id={{d[0].id}}">
                    <img src="{{d[0].cover}}" alt="Image">
                </a>
                <span class="effect"></span>
            </div>
            <!-- /.card-image -->
            <div class="card-content w100dt">
                <p>
                    {{d[0].label}}
                </p>
                <a href="single-blog.html?id={{d[0].id}}" class="card-title">
                    {{d[0].title}}
                </a>
                <ul class="post-mate-time left">
                    <li>
                        <p class="hero left">
                            By - <a href="personal.html?id={{d[0].authorId}}" class="l-blue">{{d[0].author_name}}</a>
                        </p>
                    </li>
                </ul>

                <ul class="post-mate right">
                    <li class="like">

                        <i class="icofont icofont-heart-alt"></i> {{d[0].good}}

                    </li>
                    <li class="comment">

                        <i class="icofont icofont-comment"></i> {{d[0].view}}

                    </li>
                </ul>
            </div>
            <!-- /.card-content -->
        </div>
        <!-- /.card -->
        {{# for (var i = 1; i < d.length; i++){ }}
        <div class="hot-post w100dt mb-10">
            <div class="hot-post-image">
                <a href="single-blog.html?id={{d[i].id}}">
                    <img src="{{d[i].cover}}" alt="Image">
                </a>
                <span class="effect"></span>
            </div>
            <!-- /.hot-post-image -->
            <div class="hot-post-stacked">
                <p>
                    <a href="#" class="tag left w100dt l-blue mb-10">{{d[i].label}}</a>
                </p>
                <a href="single-blog.html?id={{d[i].id}}" class="sm-name mb-10">{{d[i].title}}</a>
                <div class="hot-post-action">
                    <p class="hero left">
                        BY - <a  href="personal.html?id={{d[i].authorId}}" class="l-blue">{{d[i].author_name}}</a>
                    </p>
                    <ul class="post-mate right">
                        <li class="comment">

                            <i class="icofont icofont-comment"></i> {{d[i].view}}

                        </li>
                    </ul>
                    <!-- /.post-mate -->
                </div>
                <!-- /.hot-post-action -->
            </div>
            <!-- /.hot-post-stacked -->
        </div>
        <!-- /.hot-post -->
        {{# } }}
    </div>
</script>
<script id="side_order_date" type="text/html">
    {{# for (var i = 0; i < d.length; i++){ }}
    <div class="hot-post w100dt p-15">
        <div class="hot-post-image">
            <a href="single-blog.html?id={{d[i].id}}">
                <img src="{{d[i].cover}}" alt="Image">
            </a>
            <span class="effect"></span>
        </div>
        <!-- /.hot-post-image -->
        <div class="hot-post-stacked">
            <p>
                <a href="#" class="tag left w100dt l-blue mb-10">{{d[i].label}}</a>
            </p>
            <a href="single-blog.html" class="sm-name mb-10">{{d[i].title}}</a>
            <div class="hot-post-action">
                <p class="hero left">
                    BY - <a  href="personal.html?id={{d[i].authorId}}" class="l-blue">{{d[i].author_name}}</a>
                </p>
                <br>
                <span>{{d[i].date}}</span>
                <ul class="post-mate right">
                    <li class="comment">

                        <i class="icofont icofont-comment"></i> {{d[i].view}}

                    </li>
                </ul>
                <!-- /.post-mate -->
            </div>
            <!-- /.hot-post-action -->
        </div>
        <!-- /.hot-post-stacked -->
    </div>
    {{# } }}
</script>
<script id="search-list" type="text/html">

    {{# for (var i = 0; i < d.length; i++){ }}
    <div class="col m6 s12">
        <div class="blogs mb-30">
            <div class="card">
                <div class="card-image">
                    <a href="single-blog.html?id={{d[i].id}}"> <img src="{{d[i].cover}}" alt="Image"></a>
                    <a class="btn-floating center-align cmn-bgcolor halfway-fab waves-effect waves-light">
                        <i class="icofont icofont-camera-alt"></i>
                    </a>
                </div>
                <!-- /.card-image -->
                <div class="card-content w100dt">
                    <p>
                        <a href="single-blog.html?id={{d[i].id}}" class="tag left w100dt l-blue mb-30">{{d[i].label}}</a>
                    </p>
                    <a href="single-blog.html?id={{d[i].id}}" class="card-title">
                        {{d[i].title}}
                    </a>
                    <p class="mb-30">
                        {{d[i].sub_title}} </p>
                    <ul class="post-mate-time left">
                        <li>
                            <p class="hero left">
                                By - <a href="personal.html?id={{d[i].authorId}}"
                                        class="l-blue">{{d[i].author_name}}</a>
                            </p>
                        </li>
                        <br>
                        <li>
                            <i class="icofont icofont-ui-calendar"></i> {{d[i].date}}
                        </li>
                    </ul>

                    <ul class="post-mate right" style="float: right">
                        <li class="like">

                                <i class="icofont icofont-heart-alt"></i> {{d[i].good}}

                        </li>
                        <li class="comment">

                                <i class="icofont icofont-comment"></i> {{d[i].view}}

                        </li>
                    </ul>
                </div>
                <!-- /.card-content -->
            </div>
            <!-- /.card -->
        </div>
        <!-- /.blogs -->
    </div>
    {{# } }}
</script>
<script id="search_userList" type="text/html">

    {{# for (var i = 0; i < d.length; i++){ }}
    <div class="col m12 s12">
        <div class="blogs mb-30" style="background-color: white">
            <div class="card">
                <div class="card-image col m2 s4">
                    <a href="personal.html?id={{d[i].id}}">
                        <img src="{{d[i].head_img}}" style="width: 100px;margin-top: 10px" salt="Image">
                    </a>
                </div>
                <!-- /.card-image -->
                <div class="card-content  col m8 s8">
                    <div class="col m12 s8">
                        <a href="personal.html?id={{d[i].id}}" class="col m2 s4">
                            <h5  style="line-height: 30px">{{d[i].username}}</h5>
                        </a>
                        {{# if(d[i].isFollow!='yes') { }}
                        <button class="layui-btn layui-btn-normal layui-btn-sm col m4 s6" id="{{ 'add_follow'+d[i].id}}" onclick="follow(this,{{d[i].id}})">+关注</button>
                        {{# }else { }}
                        <button class="layui-btn layui-btn-normal layui-btn-sm col m4 s6" id="{{ 'cancel_follow'+d[i].id}}" onclick="follow(this,{{d[i].id}})">取消关注</button>
                        {{#   } }}
                    </div>
                    <small class="col m3 s6 " style="margin-top: 20px">博文：{{d[i].article}}</small>
                    <small class="col m3 s6" style="margin-top: 20px">粉丝：{{d[i].follow}}</small>
                </div>
                <!-- /.card-content -->
            </div>
            <!-- /.card -->
        </div>
        <!-- /.blogs -->
    </div>
    {{# } }}
</script>
<script id="key-tag" type="text/html">
    {{# for (var i = 0; i < d.length; i++){ }}
    <li id="{{d[i].name}}" onclick="search_key(this)"><a >{{d[i].name}}</a>
    </li>
    {{#   }  }}
</script>
<!--		渲染逻辑-->
<script>

    $(document).ready(function () {
        // 用户信息获取
        if($.cookie("username")!=null){
            let username=$.cookie("username");
            let user = $('#user');
            user.text(username);
            user.attr("href", "personal.html?id="+$.cookie("userId"));
            let userSwitch = $('.userSwitch');
            userSwitch.addClass("showUserSwitch");
            let person=$('#person');
            person.attr("href", "personal.html?id="+$.cookie("userId"));
            person.css("display","block");
        }



    });

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) {
                return decodeURIComponent(pair[1]);
            }
        }
        return false;
    }

    function search_key(obj){
        document.getElementById('search-box').value=obj.id;
        let category=$('.Class').attr("id");
        let Class=category=='blog'?'article':'user';
        search(null, null, Class);
    }


        let laytpl = layui.laytpl;
        let laypage = layui.laypage;

        //侧边栏渲染
        $.ajax({
            url: 'article/searchByCondition',
            type: 'get',
            data: {condition: 'group'},
            dataType: 'json',
            success: function (data) {
                let model = document.getElementById('side_feature').innerHTML;
                let view = document.getElementById('feature');
                laytpl(model).render(data.data, function (html) {
                    view.innerHTML = html;
                    return false;
                })
            }
        });

        $.ajax({
            url: 'article/searchByCondition',
            type: 'get',
            data: {condition: 'limit', order: 'view', limit: 3},
            dataType: 'json',
            success: function (data) {
                let model = document.getElementById('side_order_view').innerHTML;
                let view = document.getElementById('test-swipe-1');
                laytpl(model).render(data.data, function (html) {
                    view.innerHTML = html;
                    return false;
                })
            }
        });
        $.ajax({
            url: 'article/searchByCondition',
            type: 'get',
            data: {condition: 'limit', order: 'date'},
            dataType: 'json',
            success: function (data) {
                let model = document.getElementById('side_order_date').innerHTML;
                let view = document.getElementById('test-swipe-2');
                laytpl(model).render(data.data, function (html) {
                    view.innerHTML = html;
                    return false;
                })
            }
        });


        $.ajax({
            url:'article/search_key',
            type:'get',
            dataType:'json',
            success:function (data) {
                let model=document.getElementById('key-tag').innerHTML;
                let view=document.getElementById('keyword')
                laytpl(model).render(data.data,function (html) {
                    view.innerHTML=html;
                })
            }
        });

        function showArticle(param, Class) {
            $.ajax({
                url: param.url,
                type: 'get',
                data: param,
                dataType: 'json',
                success: function (data) {
                    //渲染模板
                    let model;
                    if (Class == 'article')
                        model = document.getElementById("search-list").innerHTML;
                    else{
                        model = document.getElementById("search_userList").innerHTML;
                        if($.cookie("username")!=null){
                            param.follow=1;
                            param.id=$.cookie("userId");
                            $.ajax({
                                url:'user/searchUserInfo',
                                type:'get',
                                dataType:'json',
                                data:param,
                                success:function (data2) {
                                    for(var i=0;i<data2.count;i++)
                                        for(var k=0;k<data.count;k++)
                                            if(data2.data[i].id==data.data[k].id){
                                                data.data[k].isFollow='yes';
                                                break;
                                            }
                                    let view = document.getElementById("list");
                                    laytpl(model).render(data.data, function (html) {
                                        view.innerHTML = html;
                                        return false;
                                    });
                                }
                            })
                        }

                    }
                    let view = document.getElementById("list");
                    laytpl(model).render(data.data, function (html) {
                        view.innerHTML = html;
                        return false;
                    });
                    // window.location = '#search-box';
                    return false;
                }
            });
            $.ajax({
                url:'article/search_key',
                type:'get',
                dataType:'json',
                success:function (data) {
                    let model=document.getElementById('key-tag').innerHTML;
                    let view=document.getElementById('keyword')
                    laytpl(model).render(data.data,function (html) {
                        view.innerHTML=html;
                    })
                }
            });

        }

        function search(order, key, Class) {
            if (key == null)
                key = document.getElementById('search-box').value;
            let param = {pageNum: 1, pageSize: 5, key: key, like: 1, where: 1,select:1}
            if (order != null)
                param.order = order;
			let url;
			if (Class == 'article')
				url = '/article/searchByCondition';
			else
				url = '/user/searchUserInfo';
            $.ajax({
                url: url
                , type: 'get'
                , dataType: 'json'
                , data: param
                , success: function (data) {
                    let category=$('.Class').attr("id")=='blog'?'博文':'用户';
                    $('.search-info h4').text("找到关于" + key + "的" + data.count + "条"+category+"记录");
                    if(data.count>0){
                        laypage.render({
                            elem: 'pagination'
                            , count: data.count
                            , limit: 5
                            , limits: [10, 20]           //可选择的每页显示条数-->
                            , curr: 1                        //起始页-->
                            , groups: 5                      //连续页码个数-->
                            , prev: '<i class="layui-icon layui-icon-left" style="font-size: 18px; color: #1E9FFF;"></i>  '                 //上一页文本-->
                            , next: '<i class="layui-icon layui-icon-right" style="font-size: 18px; color: #1E9FFF;"></i>  '                 //下一页文本-->
                            , first: '首页'                     //首页文本-->
                            , last: '尾页'
                            , layout: ['limit', 'count', 'prev', 'page', 'next']
                            , theme: '#2962ff'
                            , jump: function (obj, first) {
                                param.pageNum = obj.curr;
                                param.pageSize = obj.limit;
                                param.url=url;
                                showArticle(param, Class)
                            }
                        });
                    }
                    else{
                        $('#list').html('<img src="img/empty.png" alt="">');
                        $('#pagination').html('');
                    }

                }
            })
        }

        //非搜索页面搜索 url获取参数
        if (getQueryVariable("key")) {
            document.getElementById('search-box').value=getQueryVariable("key");
            search(null, getQueryVariable("key"), 'article');
        }
        //搜索页面搜索
        // 点击回车按钮
        $('#search-box').keydown(function (event) {
            if(document.getElementById('search-box').value=='')
                return;
            if (event.which == 13){
                if(document.getElementById('search-box').value=='')
                    return;
                let category=$('.Class').attr("id");
                let Class=category=='blog'?'article':'user';
                search(null, null, Class);
            }

        });

        //点击搜索按钮
        $('#search').click(function () {
            if(document.getElementById('search-box').value=='')
                return;
            let category=$('.Class').attr("id");
            let Class=category=='blog'?'article':'user';
            search(null, null, Class);
        });

        //分类按钮
        $('.article').click(function () {
            $('.a-order').css("display", "block");
            $('.u-order').css("display", "none");
            $('.Class').attr("id","blog");
            search(null, null, 'article');
        });

        $('.user').click(function () {
            $('.u-order').css("display", "block");
            $('.a-order').css("display", "none");
            $('.Class').attr("id","User");
            search(null, null, 'user');
        });

        //点击排序按钮

        //文字排序
        $('.a-order').click(function () {
            search(this.id, null, 'article');
        });

        //用户排序
        $('.u-order').click(function () {
            search(this.id, null, 'user');
        });






    function follow(obj,id) {
        if($.cookie("userId")!=null){
            if($.cookie("userId")==id){
                layer.msg("不可关注自己",{time:1*1000});
                return;
            }
            let param={follow_id:id,follower_id:$.cookie("userId")};
            if(obj.id.startsWith("add_follow")){
                param.add=1;
                obj.id='cancel_follow'+id;
                obj.innerText="取消关注"
            }else {
                param.delete=1;
                obj.id='add_follow'+id;
                obj.innerText="+关注"
            }
            $.ajax({
                url: '/article/follow',
                type: 'post',
                dataType: 'json',
                data: param,
                success: function () {
                    return false;
                }
            })
        }
        else layer.msg("请先登录",{time:1*1000});

    }
</script>


</body>

</html>